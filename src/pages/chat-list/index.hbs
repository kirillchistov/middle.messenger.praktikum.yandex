{{!< layouts/default}}

{{#content "styles"}}
<link rel="stylesheet" href="./chat-list.css">
{{/content}}

{{#content "scripts"}}
<script src="./chat-list.js" defer></script>
{{/content}}

<div class="chat-layout">
    <!-- –°–∞–π–¥–±–∞—Ä —Å —á–∞—Ç–∞–º–∏ -->
    <aside class="chat-sidebar">
        <div class="sidebar-header">
            <div class="sidebar-search">
                <input 
                    type="text" 
                    placeholder="–ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤..." 
                    class="search-input"
                    data-testid="chat-search"
                >
            </div>
            
            <button class="button button--small" data-testid="new-chat-btn">
                –ù–æ–≤—ã–π —á–∞—Ç
            </button>
        </div>
        
        <div class="chat-list" data-testid="chat-list">
            {{#each chats}}
                {{> components/ChatItem
                    id=id
                    title=title
                    avatar=avatar
                    lastMessageText=lastMessageText
                    lastMessageTime=lastMessageTime
                    lastMessageAuthor=lastMessageAuthor
                    unreadCount=unreadCount
                    active=active
                    isGroup=isGroup
                }}
            {{/each}}
        </div>
    </aside>
    
    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ -->
    <main class="chat-main">
        <div class="chat-header">
            <div class="chat-info">
                <div class="chat-avatar">
                    <img src="{{currentChat.avatar}}" alt="{{currentChat.title}}" width="48" height="48">
                    {{#if currentChat.isGroup}}
                    <span class="chat-group-badge">–ì</span>
                    {{/if}}
                </div>
                <div class="chat-details">
                    <h2 class="chat-title">{{currentChat.title}}</h2>
                    <p class="chat-members">{{currentChat.memberCount}} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</p>
                </div>
            </div>
            
            <div class="chat-actions">
                <button class="button button--small button--secondary" data-testid="add-user-btn">
                    –î–æ–±–∞–≤–∏—Ç—å
                </button>
                <button class="button button--small button--secondary" data-testid="remove-user-btn">
                    –£–¥–∞–ª–∏—Ç—å
                </button>
            </div>
        </div>
        
        <div class="messages-container" data-testid="messages-container">
            {{#each messages}}
                {{> components/Message
                    id=id
                    text=text
                    authorName=authorName
                    avatar=avatar
                    time=time
                    isOwn=isOwn
                    withAvatar=withAvatar
                    attachments=attachments
                }}
            {{/each}}
        </div>
        
        <div class="message-input-area">
            <button class="attachment-btn" data-testid="add-attachment-btn" title="–î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª">
                üìé
            </button>
            
            <input 
                type="text" 
                name="message" 
                class="message-input" 
                placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                data-testid="message-input"
            >
            
            <button class="send-btn" data-testid="send-message-btn" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">
                –û—Ç–ø—Ä–∞–≤–∏—Ç—å
            </button>
        </div>
    </main>
</div>